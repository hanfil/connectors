<html>
    <head>
        <meta charset="utf-8">
        <link href="case.css" rel="stylesheet">
        <title>{{ case_name }}_{{ case_report_date }}</title>
        <meta name="description" content="{{ case_name }}_{{ case_report_date }}">
    </head>

    <body>
        <article id="cover">
            <div id="case-marking" class="{{ case_marking[4:] }}">{{ case_marking }}</div>
            <div id="case-date">{{ case_report_date }}</div>
            <div id="cover-logo">
                <img src="Sicra-Logo-Lockup-Horizontal-WithoutR-Black.svg" alt="Logo">
            </div>
            <h1>Hendelsesrapport</h1>
            <div id="case-name">{{ case_name }}</div>
            <div id="case-contact">
                <p>{{ company_email }}</p>
                <p>{{ company_phone_number }}</p>
            </div>
        </article>

        <article id="columns">
            
            <section>
                <!-- <h3 id="details-title">Details</h3> -->
                <table class="incident-table">
                    <thead>
                        <tr>
                            <th colspan="2">
                                Hendelsesniv책:
                                <span class="severity-{{ case_severity|lower }}">
                                    {{ case_severity.upper() }}
                                </span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <b>Alvorlighetsgrad:</b>
                                <p>{{ case_priority }}</p>
                                <p><i>{{ case_priority_desc }}</i></p>
                            </td>
                            <td>
                                <b>Klassifisering:</b>
                                {% for classification in response_types %}
                                <p>{{ classification }}</p>
                                {% endfor %}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section>
                <h2 id="description-title">Innledning</h2>
                <div>{{ case_description }}</div>
            </section>
            <section id="break">
                {% if tasks.edges %}
                {% if tasks.edges|length > 0 %}
                {% for edges in tasks %}
                <h3 id="task_type-title">Tasks list</h3>
                <table>
                    <tbody>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Due Date</th>
                            <th>Status</th>
                        </tr>
                        {% for edge in tasks.edges %}
                        <tr>
                            <td>{{ edge.node.name }}</td>
                            <td>{{ edge.node.description }}</td>
                            <td>{{ edge.node.due_date }}</td>
                            <td>
                                {% if edge.node.status is not none %}
                                    {{ edge.node.status.template.name }}
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% endfor %}
                {% endif %}
                {% endif %}
            </section>
        </article>
        <article id="content">
            <h2 id="content-title">
                Oppsummering
            </h2>
            {{case_content}}
        </article>
        
        <article id="contents">
            <section id="break">
                <h2>Innhold</h2>
                <ul>
                    <li><a href="#description-title"></a></li>
                    <li><a href="#content-title"></a></li>
                    <li><a href="#analysis-title"></a>
                    <ul>
                        <li><a href="#analysis-recon"></a></li>
                        <li><a href="#analysis-delivery"></a></li>
                        <li><a href="#analysis-exploit"></a></li>
                        <li><a href="#analysis-install"></a></li>
                        <li><a href="#analysis-command"></a></li>
                        <li><a href="#analysis-objectives"></a></li>
                    </ul>
                    </li>

                    {% if tasks.edges %}
                    {% if tasks.edges|length > 0 %}
                    <li><a href="#task_type-title"></a></li>
                    {% endif %}
                    {% endif %}
                </ul>
            </section>
        </article>


        <article id="contents">
            {% set phases = [
                {'id': 'analysis-recon', 'key': 'recon', 'title': 'Fase 1: Rekognosering', 'icon': 'recon.svg', 'label': 'RECON'},
                {'id': 'analysis-delivery', 'key': 'delivery', 'title': 'Fase 2: Initiell s책rbarhetsvektor', 'icon': 'delivery.svg', 'label': 'DELIVERY'},
                {'id': 'analysis-exploit', 'key': 'exploit', 'title': 'Fase 3: Utnyttelse av s책rbarhet og svakheter', 'icon': 'exploit.svg', 'label': 'EXPLOIT'},
                {'id': 'analysis-install', 'key': 'install', 'title': 'Fase 4: Fotfeste', 'icon': 'install.svg', 'label': 'INSTALL &<br>PERSIST'},
                {'id': 'analysis-command', 'key': 'command', 'title': 'Fase 5: Kommandosenter', 'icon': 'command.svg', 'label': 'COMMAND &<br>CONTROL'},
                {'id': 'analysis-objectives', 'key': 'objectives', 'title': 'Fase 6: Angrepsm책l', 'icon': 'actions.svg', 'label': 'ACTIONS ON<br>OBJECTIVES'}
            ] %}

            {% for phase in phases %}
            <section id="break" class="phase-section" data-phase="{{ phase.key }}">
                
                
                <div class="main-content">
                {% if phase.id == 'analysis-recon' %}
                <h2 id="analysis-title">Detaljert analyse av angrepet</h2>
                {% endif %}
                <h3 id="{{ phase.id }}">{{ phase.title }}</h3>
                Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

                Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

                Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

                Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

                Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.
                </div>

                <div class="attack-chain-sidebar">
                    <div class="sidebar-step {% if phase.id == 'analysis-recon' %}active{% endif %}">
                        <img src="recon.svg" alt="Recon" class="sidebar-icon">
                        <div class="sidebar-label">RECON</div>
                    </div>
                    <div class="sidebar-step {% if phase.id == 'analysis-delivery' %}active{% endif %}">
                        <img src="delivery.svg" alt="Delivery" class="sidebar-icon">
                        <div class="sidebar-label">DELIVERY</div>
                    </div>
                    <div class="sidebar-step {% if phase.id == 'analysis-exploit' %}active{% endif %}">
                        <img src="exploit.svg" alt="Exploit" class="sidebar-icon">
                        <div class="sidebar-label">EXPLOIT</div>
                    </div>
                    <div class="sidebar-step {% if phase.id == 'analysis-install' %}active{% endif %}">
                        <img src="install.svg" alt="Install" class="sidebar-icon">
                        <div class="sidebar-label">INSTALL &amp;<br>PERSIST</div>
                    </div>
                    <div class="sidebar-step {% if phase.id == 'analysis-command' %}active{% endif %}">
                        <img src="command.svg" alt="Command" class="sidebar-icon">
                        <div class="sidebar-label">COMMAND &amp;<br>CONTROL</div>
                    </div>
                    <div class="sidebar-step {% if phase.id == 'analysis-objectives' %}active{% endif %}">
                        <img src="actions.svg" alt="Actions" class="sidebar-icon">
                        <div class="sidebar-label">ACTIONS ON<br>OBJECTIVES</div>
                    </div>
                </div>
            </section>
            {% endfor %}
        </article>

        <article id="contents">
            <div id="break"></div>
            {% if entities %}
            <h3>Entities</h3>
            <ul>
                {% for entity_type in entities %}
                <li><a href="#{{ entity_type }}-title"></a></li>
                {% endfor %}
            </ul>
            {% endif %}

            {% if observables %}
            <h3>Observables</h3>
            <ul>
                {% for observable_type in observables %}
                <li><a href="#{{ observable_type }}-title"></a></li>
                {% endfor %}
            </ul>
            {% endif %}
            {% if case_external_refs %}
            <h3>External References</h3>
            <ul>
                <li><a href="#External-References-title"></a></li>
            </ul>
            {% endif %}
        </article>

        <article id="entities">
            {% for entity_type in entities %}
            <h3 id="{{ entity_type }}-title">{{ entity_type }}</h3>
            <section id="{{ entity_type }}">
                <div style="clear:both;"></div>
                <table>
                    <tbody>
                    {% for entity in entities[entity_type] %}

                    <tr>
                        <th>Name</th>
                    </tr>
                    <tr>
                        <td>
                            <pre>{{ entity.name }}</pre>
                        </td>
                    </tr>

                    {% if entity_type == 'Attack-Pattern' %}
                    <tr>
                        <th>ID</th>
                    </tr>
                    <tr>
                        <td>
                            {{ entity.x_mitre_id }}
                        </td>
                    </tr>
                    {% endif %}

                    {% if entity.description %}
                    <tr>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>
                            {{ entity.description }}
                        </td>
                    </tr>
                    {% endif %}

                    {% if entity_type == 'Indicator' %}
                    <tr>
                        <th>Pattern Type</th>
                    </tr>
                    <tr>
                        <td>
                            {{ entity.pattern_type }}
                        </td>
                    </tr>
                    <tr>
                        <th>Pattern</th>
                    </tr>
                    <tr>
                        <td>
                            <pre>{{ entity.pattern }}</pre>
                        </td>
                    </tr>
                    {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
            </section>
            {% endfor %}
        </article>
        <article id="observables">
            {% for observable_type in observables %}
            <h3 id="{{ observable_type }}-title">{{ observable_type }}</h3>
            <section id="{{ observable_type }}">
                <table>
                    <tr>
                        <th>Value</th>
                    </tr>
                    {% for observable in observables[observable_type] %}
                    <tr>
                        <td>
                            {{ observable.observable_value }}
                        </td>
                    </tr>
                    {% endfor %}
                </table>
            </section>
            {% endfor %}
        </article>
        <article id="external-references">
            {% if case_external_refs %}
            <h3 id="External-References-title">External References</h3>
            {% endif %}
            <section>
                <ul>
                    {% for external_ref in case_external_refs %}
                    <li><a href="{{ external_ref }}" target="_blank">{{ external_ref }}</a></li>
                    {% endfor %}
                </ul>
            </section>
        </article>
    </body>
</html>
